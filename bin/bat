#!/bin/sh
#
# bat

manual() {
    BAT="/sys/class/power_supply/BAT0"
    test -d "$BAT" || return 0

    CHR="$(cat "$BAT/charge_now")"
    MAX="$(cat "$BAT/charge_full")"
    STATUS="$(cat "$BAT/status")"
    PERCENT="$(printf '%.2f\n' "$(echo "$CHR/$MAX*100" | bc -l)" | cut -d. -f 1)"
}

acpidata() {
    ACPINFO="$(acpi -b)"
    PERCENT="$(printf '%s\n' "$ACPINFO" | cut -d\  -f 4 | cut -d% -f 1)"
    STATUS="$(printf '%s\n' "$ACPINFO" | cut -d\  -f 3 | cut -d, -f 1)"
}

case "$1" in
    m|manual) manual   ;;
    a|acpi)   acpidata ;;
    *)        acpidata ;;
esac

hash acpi 2> /dev/null || exit 1

case "$STATUS" in
    "Full"|"Charging")
        printf '%s\n' "$PERCENT% /"
        ;;
    "Discharging")
        printf '%s\n' "$PERCENT% _"
        ;;
esac
