#!/bin/zsh

. fwmrc
wmenv
wmgaps
dcolours

FONT=$(awk '/font/ {print $3}' < ~/.Xresources | cut -d',' -f 1)

X=$((LGAP + BW))
H=$((BGAP/2 + BW*2))
Y=$(($(mattr h $PRI) - H - BGAP/4))
W=$(($(mattr w $PRI) - LGAP - RGAP - BW*2))

printf '%s\n' "$PATH" | sed 's/:/\n/g' | while read -r dir; do
    printf '%s\n' "$(find -L $dir/* -type f -executable)" | \
        rev | cut -d/ -f 1 | rev
done | sort -u | \
dmenu -name "drun" -f -i -x $X -y $Y -w $W -h $H -bw 0 -s "$PRI" \
-fn "$FONT" -p "  Run >" \
-nf "#$NF" -sf "#$SF" -nb "#$NB" -sb "#$SB" -bc "#$BC" \
| ${SHELL:-"/bin/sh"} &
